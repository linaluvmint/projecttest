<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Update</title>
<style>
  body{margin:0;padding:40px 20px 80px;font-family:'Segoe UI',Tahoma,sans-serif;
    background:linear-gradient(to bottom right,#c8e6c9,#e8f5e9);min-height:100vh;color:#1b5e20;}
  #createBtn{position:fixed;top:20px;left:20px;background:#1b5e20;color:white;border:none;
    padding:12px 22px;border-radius:12px;font-weight:700;cursor:pointer;
    box-shadow:0 4px 14px rgba(27,94,32,0.7);z-index:1000;}
  #createBtn:hover{background:#145214;}
  h1{text-align:center;margin-bottom:20px;}
  #updatesContainer{max-width:850px;margin:100px auto 0;display:flex;flex-wrap:wrap;gap:15px;justify-content:center;}
  .update-btn{background:#388e3c;color:white;border:none;padding:16px 28px;border-radius:14px;font-weight:600;font-size:16px;
    cursor:pointer;box-shadow:0 6px 14px rgba(56,142,60,0.3);}
  .update-btn:hover{background:#1b5e20;}
</style>
</head>
<body>

<button id="createBtn">Create Updates</button>
<h1>Updates</h1>
<div id="updatesContainer"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getFirestore, collection, getDocs, orderBy, query } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

  
  const firebaseConfig = {
    apiKey: "AIzaSyD5kksl475n1Blo9tjP9KVMSrebO8AFJxc",
    authDomain: "latenight-4c61a.firebaseapp.com",
    projectId: "latenight-4c61a",
    storageBucket: "latenight-4c61a.firebasestorage.app",
    messagingSenderId: "208698993180",
    appId: "1:208698993180:web:7741767d129b4d43034dd9",
    measurementId: "G-MVKZ0R87Y3"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  document.getElementById('createBtn').onclick=()=>window.location.href='create.html';
  const updatesContainer=document.getElementById('updatesContainer');

  function shadeColor(color,percent){
    let R=parseInt(color.substring(1,3),16),G=parseInt(color.substring(3,5),16),B=parseInt(color.substring(5,7),16);
    R=parseInt(R*(100+percent)/100);G=parseInt(G*(100+percent)/100);B=parseInt(B*(100+percent)/100);
    R=(R>255)?255:R;G=(G>255)?255:G;B=(B>255)?255:B;
    return "#"+R.toString(16).padStart(2,"0")+G.toString(16).padStart(2,"0")+B.toString(16).padStart(2,"0");
  }

  async function loadUpdates(){
    const q=query(collection(db,"updates"),orderBy("createdAt","desc"));
    const snap=await getDocs(q);
    updatesContainer.innerHTML='';
    if(snap.empty){updatesContainer.innerHTML=`<p style="font-style:italic;text-align:center;width:100%;">Tiada update lagi</p>`;return;}
    snap.forEach(doc=>{
      const data=doc.data();
      const btn=document.createElement('button');
      btn.className='update-btn';
      btn.textContent=data.tajuk||'(Tiada tajuk)';
      const themeColor=data.themeColor||'#388e3c';
      btn.style.backgroundColor=themeColor;
      btn.style.boxShadow=`0 6px 14px ${shadeColor(themeColor,10)}`;
      btn.onclick=()=>window.location.href=`update.html?id=${doc.id}`;
      updatesContainer.appendChild(btn);
    });
  }
  loadUpdates();
</script>
</body>
</html>
